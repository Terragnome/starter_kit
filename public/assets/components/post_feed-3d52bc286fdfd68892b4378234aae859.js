var PostFeed=PostFeed||{};PostFeed.init=function(){PostFeed.isLoading=!1,PostFeed._loader=$("#post_feed_loader"),Scroll.onScroll.callbacks.add(PostFeed.onScroll)},PostFeed.onScroll=function(){if("none"==DOM._sceneLoader.css("display")&&!PostFeed.isLoading){PostFeed._feed=$("#post_feed");var e=PostFeed._feed;if(e&&!(e.length<=0)){e=e.first();var o=DOM._window.scrollTop(),t=DOM._document.height()-DOM._window.outerHeight(),s=!1,d=o>=t;if(s||d){PostFeed.isLoading=!0;var a=e.find(".feed_list");if(s){a=a.first();var i=a.attr("prev_url"),r=a.attr("prev_ajax");i?PostFeed.loadMore(i,r,"prev",!0):PostFeed.isLoading=!1}else{a=a.last();var n=a.attr("next_url"),l=a.attr("next_ajax");n?PostFeed.loadMore(n,l,"next",!0):PostFeed.isLoading=!1}}}}},PostFeed.loadMore=function(e,o,t,s){PostFeed._loader.show(),$(".more_posts").hide();$.ajax({type:"GET",url:o,data:{scroll:t},dataType:"script"}).done(function(){s&&history.pushState({id:e},"",e);var o=$(".feed_list"),d=o.last();if(o.each(function(e,o){$(o)[0]!=d[0]&&$(o).find(".more_posts").remove()}),"next"==t);else if("prev"==t){var a=o.first();s&&Scroll.autoScrollTo($(a).height())}Post.init(d)}).fail(function(){}).always(function(){PostFeed._loader.hide(),$(".more_posts").show(),PostFeed.isLoading=!1})};