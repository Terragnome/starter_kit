var PostFeed=PostFeed||{};PostFeed.init=function(){PostFeed._loader=$("#post_feed_loader"),PostFeed.enableScroll()},PostFeed.enableScroll=function(){Scroll.onScroll.callbacks.add(PostFeed.onScroll)},PostFeed.disableScroll=function(){Scroll.onScroll.callbacks.remove(PostFeed.onScroll)},PostFeed.onScroll=function(){if("none"==DOM._sceneLoader.css("display")){PostFeed._feed=$("#post_feed");var e=PostFeed._feed;if(e&&!(e.length<=0)){e=e.first();var o=DOM._window.scrollTop(),t=DOM._document.height()-DOM._window.outerHeight(),d=!1,s=o>=t;if(d||s){var l=e.find(".feed_list");if(d){l=l.first();var a=l.attr("prev_url"),r=l.attr("prev_ajax");a&&(PostFeed.disableScroll(),PostFeed.loadMore(a,r,"prev",!0))}else{l=l.last();var n=l.attr("next_url"),i=l.attr("next_ajax");n&&(PostFeed.disableScroll(),PostFeed.loadMore(n,i,"next",!0))}}}}},PostFeed.showLoader=function(){PostFeed._loader.show(),PostFeed._loader.addClass("anim_fade_in")},PostFeed.hideLoader=function(){PostFeed._loader.hide(),PostFeed._loader.removeClass("anim_fade_in")},PostFeed.loadMore=function(e,o,t,d){PostFeed.showLoader(),$(".more_posts").hide();$.ajax({type:"GET",url:o,data:{scroll:t},dataType:"script"}).done(function(){d&&history.pushState({id:e},"",e);var o=$(".feed_list"),s=o.last();if(o.each(function(e,o){$(o)[0]!=s[0]&&$(o).find(".more_posts").remove()}),"next"==t);else if("prev"==t){var l=o.first();d&&Scroll.scrollTo($(l).height())}Post.init(s),s.addClass("anim_fade_in")}).fail(function(){}).always(function(){PostFeed.hideLoader(),$(".more_posts").show(),PostFeed.enableScroll()})};