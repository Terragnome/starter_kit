var PostFeed=PostFeed||{};PostFeed.init=function(){PostFeed._loader=$("#post_feed_loader"),PostFeed.enableScroll()},PostFeed.enableScroll=function(){Scroll.onScroll.callbacks.add(PostFeed.onScroll)},PostFeed.disableScroll=function(){Scroll.onScroll.callbacks.remove(PostFeed.onScroll)},PostFeed.onScroll=function(){if("none"==DOM._sceneLoader.css("display")){PostFeed._feed=$("#post_feed");var e=PostFeed._feed;if(e&&!(e.length<=0)){e=e.first();var o=DOM._window.scrollTop(),t=DOM._document.height()-DOM._window.outerHeight(),d=!1,l=o>=t;if(d||l){var s=e.find(".feed_list");if(d){s=s.first();var a=s.attr("prev_url"),r=s.attr("prev_ajax");a&&(PostFeed.disableScroll(),PostFeed.loadMore(a,r,"prev",!0))}else{s=s.last();var i=s.attr("next_url"),n=s.attr("next_ajax");i&&(PostFeed.disableScroll(),PostFeed.loadMore(i,n,"next",!0))}}}}},PostFeed.showLoader=function(){PostFeed._loader.show(),PostFeed._loader.addClass("anim_fade_in")},PostFeed.hideLoader=function(){PostFeed._loader.hide(),PostFeed._loader.removeClass("anim_fade_in")},PostFeed.loadMore=function(e,o,t,d){PostFeed.showLoader(),$(".more_posts").hide();$.ajax({type:"GET",url:o,data:{scroll:t},dataType:"script"}).done(function(){if(d){var o={id:e,path:window.location.href,scrollTop:DOM.getPageTop()};history.pushState(o,"",e)}var l=$(".feed_list"),s=l.last();if(l.each(function(e,o){$(o)[0]!=s[0]&&$(o).find(".more_posts").remove()}),"next"==t);else if("prev"==t){var a=l.first();d&&Scroll.scrollTo($(a).height())}Post.init(s),s.addClass("anim_fade_in")}).fail(function(){}).always(function(){PostFeed.hideLoader(),$(".more_posts").show(),PostFeed.enableScroll()})};